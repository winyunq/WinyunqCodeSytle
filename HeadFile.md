# Winyunq 风格：头文件注释规范 (Head File Comment Style)

本文件描述了 Winyunq 风格中 `/** ... **/` 块注释的严格使用规范，主要应用于头文件中的主要结构定义。

## 头文件引用规范

*   **第三方库头文件:** 使用尖括号 `<>` 进行引用 (例如: `#include <string>`)。
*   **项目内部头文件:** 使用双引号 `""` 进行引用 (例如: `#include "DataProcessor.h"`)。

## 5. `/** ... **/` - 主要结构的文档中心 (强制覆盖规则 - 特例)

*   **5.1 核心作用:** 标记一个**主要结构单元的定义体** (`{}` 块)，提供全面、结构化的文档。这是对默认 `///` 规则的**特例覆盖**。
*   **5.2 强制触发条件 (必须取代 `///`):**
    *   **必须**应用于以下元素的**定义 (Definition)**：
        *   `class` 定义 (带 `{...}`)
        *   `struct` 定义 (带 `{...}`)
        *   `enum class` / `enum` 定义 (带 `{...}`)
        *   `namespace` 定义 (带 `{...}`)
        *   **所有函数定义** (带 `{...}` 实现体)，包括：
            *   普通成员函数、静态成员函数、虚函数。
            *   **构造函数、析构函数**。
            *   **模板函数定义**。
            *   重载运算符函数定义。
            *   全局函数、命名空间内的非成员函数定义。
    *   **重要说明:** 触发条件**仅基于代码元素的语义类型（是否为主要结构定义）**，**与注释内容的长度或复杂度无关**。
        *   **目的 (Purpose):** 体现核心原则 2，强制区分代码的“骨架”与“其他部分”。定义处是提供详尽文档的逻辑位置，与 Doxygen 等工具期望一致，但 Winyunq 规则优先。
*   **5.3 禁止应用:**
    *   **绝对禁止**对任何**声明** (函数原型、类前向声明等) 使用 `/** ... **/`。
    *   **绝对禁止**对**函数体内部**的语句或局部声明使用 `/** ... **/`。
    *   **Lambda 表达式** (`[]{}`) **禁止**使用 `/** ... **/`，其实现逻辑应足够简单，或通过其上下文函数的 `/**` 解释。
        *   **目的 (Purpose):** 严格维护 `/**` 作为**主要结构定义**文档标记的纯粹性。

*   **5.4 格式规则 (强制):**
    *   **位置:** `/** ... **/` 块本身**必须顶格** (从第 1 列开始)，**禁止**任何缩进。
        *   **即使其所注释的代码元素（如类成员函数）本身有缩进，注释块也必须从文件最左侧开始。**
        *   **示例:**
            ```cpp
            class MyClass {
                public:
            /**
             * @brief 这是一个顶格的函数注释。
             *  @details 即使函数声明有缩进，注释块也必须从第1列开始。
             **/
                void MyFunction();
            };
            ```
        *   **目的 (Purpose):** 使其在代码中成为醒目的视觉地标，标记主要逻辑单元。
    *   **内部结构:** 遵循**第 6 章**的“默认模式”或“函数特化模式”。
    *   在`/** ... **/`中，不会使用`Tab`，可用理解为在`/**`注释中，`Tab`是0个空格，从而`/**`注释**不会参与缩进**。

## 6. `/** ... **/` (WinyunqDoxygen Block) 规则 (信息中心的构建 - 强制格式)

*   **6.0 Winyunq 与 Doxygen 的关系:**
    *   Winyunq 风格**使用** Doxygen 兼容的 `/** ... */` 块注释和 `@tag` 语法作为基础。
    *   Winyunq 的**核心价值**在于对 Doxygen 的灵活性进行了**严格的约束、优化和统一**，旨在实现极致的**一致性**和**可读性**。
    *   **规则优先级:** 当 Winyunq 对格式、标签使用、触发条件、内部结构等做出明确规定时，这些规定**必须**遵守，并**优先于** Doxygen 的默认行为或其他风格。
    *   **目的 (Purpose):** 借助 Doxygen 的生态和工具兼容性，同时强制执行 Winyunq 的高标准，实现风格统一和文档质量提升。

*   **6.1 核心目标：可扫描性、信息密度、结构化**
    *   **核心对齐基准列 (强制定义):** Winyunq 定义了三个核心基准列，用于创建可扫描的视觉结构。列号从行首第 1 个字符开始计算，`Tab` 字符在`/**`环境**不会使用**，对齐**必须**通过添加**空格**实现精确控制。
        *   左对齐的核心原则：**绝对列位置**，对齐是基于代码编辑器中的绝对列，不受前导文本长度影响。工具辅助：建议使用支持列标尺的编辑器（如VS Code的插件），确保对齐到15和35列。
        *   **基准列 1 (Col 3):** `*` 后的第一个空格之后的位置。这是所有**后续**描述文本行（非首行，所在行**没有**`@`）的起始列。
        *   **基准列 2 (Col 15):** Doxygen命令 (`@brief`, `@param`, `@return` 等) 后的**首行描述文本**的起始列，注意，**受到前导空格影响**
        *   **基准列 3 (Col 35):** `@param`/`@return` 的 `"数据类型:"` 标签后的 **实际数据类型文本** 的起始列。其**左对齐固定在第35列**（不足35则补充空格使得**视觉上**对齐35列，超过35则**补充一个空格**）**不守前导空格影响**
        *   **目的 (Purpose):** 创建稳定、可预测、易于机器和人类解析的视觉结构，最大限度降低阅读和理解成本。
        *   注意：基准**禁止缩进**，基准始终以最左侧为起点，完全遵循左对齐

*   **6.2 默认块结构 (适用于 Class/Struct/Enum/Namespace 定义):**
    *   **结构:**
        *   1.  **禁止空行:** `/** ... **/`最终目的用于Doxygen生成手册，只考虑Doxygen排版效果，**不允许**使用物理空行分割。 
        *   2.  **结构类型标签:** `@class Name`, `@struct Name`, `@enum Name`, `@namespace Name`。
        *   3.  **摘要:** `@brief` (必须)。
        *   4.  **继承关系 (若有, 仅限 Class/Struct):** `@extends [可见性] [基类名]` (每个基类一行，Winyunq 约定，使用 `@extends`)。
        *   5.  **详细描述 (可选但推荐):** `@details`。
        *   6.  **补充说明 (可选，挂载于 @details 下):**`其他doxygen命令`(`@note`, `@warning`, `@todo` 等)**未提及的Doxygen命令均为补充说明**。
    *   **标签说明与层级:**
        *   `@class`/`@struct`/`@enum`/`@namespace`: (0 空格) 标识结构类型。
        *   `@brief`: (0 空格) 核心功能摘要。
        *   `@extends`: (0 空格) 描述继承关系。可见性 (`public`, `protected`, `private`) 和基类名。
        *   `@details`: (1 空格) 详细解释、背景、设计原理等。
        *   `其他doxygen命令`(`@`开头的Doxygen命令，例如`@note`/`@warning`/`@todo`): (2 空格) 从属于 `@details`，即凡是未提及的Doxygen命令，**默认**挂载于`@details`下。
            *   **目的 (Purpose for nesting under @details):** 补充信息通常需要详细背景。
        *   **一旦换行**，换行后的内容遵循**基准列 1 (Col 3):**，即任何左侧没有`@`开头的Doxygen命令，则遵循**基准列 1 (Col 3):**

*   **6.3 函数块结构 (特化模式):**
    *   **结构:** 基于默认结构 (`@brief`, `@details`，`其他doxygen命令`等)，**在它们之后**，按顺序添加函数特有的部分。
        *   1.  **基础信息** : `@brief`, `@details`, `其他doxygen命令`等从属标签
        *   2.  **函数参数 (若有):** `@param 参数名称: [Name] 数据类型:[Type]` (每个一行，可带 `@details`, `@note` 子标签)。**函数信息**与**基础信息**存在**换行**
        *   3.  **模板参数（若有）**模板参数被视为特殊参数，仅将`@param`改为`@tparam`，视为第一个参数。
        *   4.  **返回值 (若非 `void`):** `@return [含义描述] 数据类型:[Type]` (可带 `@details`, `@retval` 子标签)。返回值与前面的内容存在**换行**
    *   **标签说明:**
        *   `@brief`: (0 空格) 函数的核心功能摘要。**覆盖** `@fn`。
        *   `@details`/`@note`/`@warning`/`@throws`/`@todo`: 同默认模式。
        *   `@tparam`: (0 空格) 描述模板参数。除Doyxgen命令改为`@tparam`，其余与`@param`**一致**
            *   **目的 (Purpose for placing before @param):** 模板参数是函数签名的一部分，逻辑上视为第一个普通参数。
        *   `@param`: (0 空格) 描述函数参数。`参数名称:` 对齐到**基准列 2 (Col 15):**，`数据类型:` 对齐到**基准列 3 (Col 35):**。可嵌套 `@details`/`@note` (1/2 空格)。
        *   `@return`: (0 空格) 描述返回值。含义描述和 `数据类型:` 后的类型文本需对齐到**基准列 3 (Col 35):**。可嵌套 `@details` (1 空格) 或 `@retval` (2 空格)。

*   **6.4 内部格式化规则 (强制):**
    *   **禁止默认对齐:** **绝对禁止**简单地将所有 `@tag` 或文本顶格 (`* @tag`) 或随意缩进。**必须**遵循 Winyunq 的基准列对齐系统。
    *   **标签行缩进层级 (强制):**
        *   `@brief`, `@class`/`@struct`/`@enum`/`@namespace`, `@extends`, `@tparam`, `@param`, `@return`: **0 空格** (`* @tag`) - 顶层信息。
        *   `@details`: **1 空格** (`*  @details`) - 从属于上方主标签，提供详细阐述。
        *   `@note`, `@warning`, `@throws`, `@todo`, `@retval`: **2 空格** (`*   @tag`) - 从属于 `@details` (或 `@param`/`@return` 的 `@details`)，提供特定角度的补充信息。
        *   **目的 (Purpose):** 通过缩进反映信息的层级和从属关系。
    *   **文本对齐 (规则覆盖 - 强制):**
        *   **规则 A (主文本/名称 - 列 15):** 标签后的首行描述、`@param` 的 `"参数名称:"`、`@return` 的含义描述，**必须**从**基准列 2 (Col 15)** 开始。
        *   **规则 B (类型文本 - 列 35):** `@param`/`@return` 的 `"数据类型:"` 标签本身从列 15 开始，其后的**实际类型**文本**必须**从**基准列 3 (Col 30)** 开始。
        *   **规则 C (后续行 - 列 3):** **任何**描述文本（无论层级）的**第二行及之后**，**必须**从**基准列 1 (Col 3)** 开始。**禁止**悬挂缩进或其他对齐方式。
        *   **目的 (Purpose):** 规则 A/B 确保列对齐。规则 C 确保多行文本块左边界统一，提高段落可读性。
    *   **内部空行 (严格限制):** 空 `*` 行**仅允许且必须**用于分隔不同的**顶级标签组** (brief/details 组, tparam/param 组, return 组)。**禁止**在组内（如多个 `@param` 之间）或多行描述内部使用。
        *   **目的 (Purpose):** 保持主要信息块间视觉分隔，同时确保块内部紧凑连续。
    *   **标签顺序 (强制，函数特化):** `@brief`,`@details` (及其从属) -> `@tparam`/`@param` -> `@return`。
        *   **目的 (Purpose): 通过一致的文档结构，便于查找。**

*   **6.5 最小化与省略规则:**
    *   **必须包含:** `@brief` (及对应的 `@class` 等)。
    *   **条件性包含:** `@extends` (若有继承), `@tparam`, `@param`, `@return` (函数)。
    *   **推荐包含:** `@details` 及从属标签。
    *   **格式不变性:** 省略可选部分时，剩余部分的**所有格式规则（对齐、缩进、内部空行、基准列）必须严格保持不变**。
        *   **目的 (Purpose):** 即使内容简化，也要维护结构的稳定性和可预测性。
    *   **默认处理方式** 凡是未明确说明的Doxygen命令，挂载于属于`@brief`下的`@details`
        *   **目的 (Purpose):** 针对未说明情况采用统一处理。
